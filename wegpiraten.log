2025-10-07 21:00:14.707 | DEBUG    | __main__:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:00:14.707 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:00:14.707 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:00:14.707 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:00:14.707 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:00:14.707 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:00:14.708 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:00:14.708 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:00:14.708 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:00:14.708 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:00:14.708 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:00:14.708 | DEBUG    | __main__:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:00:14.708 | INFO     | __main__:<module>:181 - Projektwurzel: /home/stephan/projects/wegpiraten
2025-10-07 21:01:36.598 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:01:36.599 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:01:36.599 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:01:36.599 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:01:36.599 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:01:36.600 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:01:36.629 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:01:36.630 | INFO     | __main__:fetch_reporting_data:63 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:01:36.630 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: Wegpiraten Datenbank.sqlite3
2025-10-07 21:02:53.533 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:02:53.533 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:02:53.534 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:02:53.534 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:02:53.534 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:02:53.534 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:02:53.535 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:02:53.535 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:02:53.535 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:02:53.535 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:02:53.535 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:02:53.536 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:02:56.464 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:02:56.467 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:08:22.691 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:08:22.692 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:08:22.692 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:08:22.692 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:08:22.693 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:08:22.693 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:08:22.693 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:08:22.693 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:08:22.693 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:08:22.693 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:08:22.694 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:08:22.694 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:08:23.607 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:08:23.639 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:08:27.531 | INFO     | __main__:fetch_reporting_data:64 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:08:27.532 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: Wegpiraten Datenbank.sqlite3
2025-10-07 21:11:03.645 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:11:03.645 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:11:03.645 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:11:03.646 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:11:03.646 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:11:03.646 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:11:03.646 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:11:03.647 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:11:03.647 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:11:03.647 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:11:03.647 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:11:03.647 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:11:05.097 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:11:05.099 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:12:04.589 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:12:04.590 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:12:04.590 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:12:04.591 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:12:04.591 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:12:04.591 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:12:04.591 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:12:04.592 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:12:04.592 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:12:04.592 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:12:04.592 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:12:04.593 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:12:05.401 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:12:05.431 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:13:58.535 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:13:58.535 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:13:58.535 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:13:58.535 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:13:58.536 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:13:58.536 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:13:58.536 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:13:58.536 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:13:58.536 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:13:58.536 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:13:58.536 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:13:58.537 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:13:59.488 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:13:59.492 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:15:03.571 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:15:03.572 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:15:03.582 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:15:03.582 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:15:03.582 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:15:03.583 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:15:03.583 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:15:03.583 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:15:03.583 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:15:03.583 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:15:03.583 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:15:03.584 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:15:04.388 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:15:04.391 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:16:26.710 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:16:26.711 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:16:26.711 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:16:26.711 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:16:26.711 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:16:26.712 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:16:26.712 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:16:26.712 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:16:26.712 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:16:26.712 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:16:26.712 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:16:26.712 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:16:27.878 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:16:27.881 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:16:34.883 | INFO     | __main__:fetch_reporting_data:64 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:16:34.884 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:16:34.893 | INFO     | __main__:fetch_reporting_data:67 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:16:34.895 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 0: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K23-13', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.895 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 1: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K23-33', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.895 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 2: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K23-47', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.896 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 3: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K23-52', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.896 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 4: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K23-53', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.896 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 5: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-12', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.897 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 6: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-14', '...ee_last_name': 'Gerner'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.897 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 7: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-15', '...ee_last_name': 'Gerner'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.897 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 8: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-21', '...yee_last_name': 'Kloos'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.898 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 9: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-23', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.898 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 10: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-25', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.898 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 11: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-27', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.898 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 12: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-28', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.899 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 13: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-3', 's...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.899 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 14: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-37', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.899 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 15: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-42', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.900 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 16: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-43', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.900 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 17: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-45', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.901 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 18: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-46', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.901 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 19: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-50', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.901 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 20: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K24-51', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.902 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 21: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-10', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.902 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 22: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-11', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.902 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 23: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-17', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.903 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 24: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-18', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.903 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 25: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-19', '..._last_name': 'Eggimann'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.903 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 26: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-22', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.904 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 27: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-24', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.904 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 28: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-26', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.904 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 29: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-30', '...yee_last_name': 'Kloos'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.904 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 30: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-31', '...ee_last_name': 'Gerner'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.905 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 31: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-34', '...ee_last_name': 'Gerner'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.905 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 32: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-35', '...ee_last_name': 'Gerner'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.905 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 33: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-36', '...yee_last_name': 'Kloos'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.906 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 34: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-38', '...ee_last_name': 'Gerner'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.906 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 35: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-39', '...yee_last_name': 'Kloos'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.906 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 36: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-40', '...yee_last_name': 'Kloos'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.906 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 37: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-41', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.907 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 38: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-44', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.907 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 39: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-48', '...yee_last_name': 'Wloka'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.907 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 40: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-49', '...yee_last_name': 'Wloka'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.907 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 41: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-5', 's...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.908 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 42: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-54', '...yee_last_name': 'Kloos'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.908 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 43: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-55', '...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.908 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 44: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-56', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.909 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 45: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-58', '...yee_last_name': 'Kloos'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.909 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 46: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-6', 's...ee_last_name': 'Gerner'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.909 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 47: 3 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
service_type
  Field required [type=missing, input_value={'client_id': 'K25-60', '...ployee_last_name': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.910 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 48: 3 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
service_type
  Field required [type=missing, input_value={'client_id': 'K25-61', '...ployee_last_name': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.910 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 49: 3 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
service_type
  Field required [type=missing, input_value={'client_id': 'K25-62', '...ployee_last_name': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.911 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 50: 3 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
service_type
  Field required [type=missing, input_value={'client_id': 'K25-63', '...ployee_last_name': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.911 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 51: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-8', 's...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:16:34.911 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 52: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K25-9', 's...ee_last_name': 'Kläsi'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:17:58.223 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:17:58.223 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:17:58.224 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:17:58.225 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:17:58.225 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:17:58.226 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:18:39.687 | INFO     | __main__:fetch_reporting_data:64 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:19:08.505 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:19:52.902 | INFO     | __main__:fetch_reporting_data:67 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:21:36.252 | ERROR    | __main__:fetch_reporting_data:75 - Ungültige Reporting-Daten in Zeile 0: 1 validation error for ReportingRowModel
service_type
  Field required [type=missing, input_value={'client_id': 'K23-13', '...yee_last_name': 'Smith'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-10-07 21:27:21.728 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:27:21.728 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:27:21.729 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:27:21.729 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:27:21.729 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:27:21.729 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:27:21.729 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:27:21.730 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:27:21.730 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:27:21.730 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:27:21.730 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:27:21.731 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:27:21.731 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:27:21.733 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:28:17.461 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:28:20.027 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:28:25.587 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:28:45.683 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 47: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:28:45.684 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 48: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:28:45.684 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 49: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:28:45.684 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 50: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:28:45.688 | ERROR    | __main__:create_reporting_sheet:95 - Fehler beim Laden des Templates: openpyxl does not support .docx file format, please check you can open it with Excel first. Supported formats are: .xlsx,.xlsm,.xltx,.xltm
2025-10-07 21:33:23.159 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:33:23.160 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:33:23.161 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:33:23.161 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:33:23.161 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:33:23.165 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:33:23.165 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:33:23.165 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:33:23.171 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:33:23.174 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 47: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:33:23.174 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 48: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:33:23.174 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 49: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:33:23.174 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 50: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:33:23.175 | ERROR    | __main__:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/zeiterfassungsboegen.xlsx'
2025-10-07 21:34:04.696 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:34:04.696 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:34:04.696 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:34:04.696 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:34:04.696 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:34:04.696 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:34:04.697 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:34:04.697 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:34:04.697 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:34:04.697 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:34:04.697 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:34:04.697 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:34:04.697 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:34:04.698 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:34:04.698 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:34:04.698 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:34:04.700 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:34:04.702 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 47: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:34:04.702 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 48: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:34:04.702 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 49: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:34:04.703 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 50: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:34:04.703 | ERROR    | __main__:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 21:35:42.251 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:35:42.252 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:35:42.253 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:35:42.253 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:35:42.253 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:35:42.254 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:35:42.254 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:35:42.254 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:35:42.256 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:35:42.259 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 47: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:35:42.259 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 48: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:35:42.259 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 49: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:35:42.259 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 50: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:35:42.260 | ERROR    | __main__:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: '/home/stephan/projects/wegpiraten/templates/zeiterfassungsboegen.xlsx'
2025-10-07 21:39:29.810 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:39:29.810 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:39:29.810 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:39:29.810 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:39:29.811 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:39:29.811 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:39:29.811 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:39:29.811 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:39:29.811 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:39:29.811 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:39:29.812 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:39:29.812 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:39:29.812 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:39:29.813 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:39:29.813 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:39:29.813 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:39:29.814 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:39:29.816 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 47: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:39:29.817 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 48: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:39:29.817 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 49: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:39:29.817 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 50: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:39:59.227 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:39:59.228 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:39:59.228 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:39:59.228 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:39:59.228 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:39:59.228 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:39:59.228 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:39:59.229 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:39:59.229 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:39:59.229 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:39:59.229 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:39:59.229 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:39:59.229 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:39:59.230 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:39:59.231 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:39:59.231 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:39:59.235 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:39:59.237 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 47: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:39:59.237 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 48: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:39:59.237 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 49: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:39:59.238 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 50: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:50:23.219 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:50:23.220 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:50:23.222 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:50:23.222 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:50:23.222 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:50:23.227 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:50:23.230 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 47: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:50:23.231 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 48: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:50:23.231 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 49: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:50:23.231 | ERROR    | __main__:fetch_reporting_data:76 - Ungültige Reporting-Daten in Zeile 50: 2 validation errors for ReportingRowModel
employee_first_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
employee_last_name
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-10-07 21:55:36.260 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:55:36.261 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:55:36.262 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:55:36.262 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:55:36.263 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:55:36.263 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:55:36.263 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:55:36.268 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:56:26.597 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:56:26.598 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:56:26.598 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:56:26.598 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:56:26.598 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:56:26.598 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:56:26.599 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:56:26.599 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:56:26.599 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:56:26.599 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:56:26.599 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:56:26.599 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:56:26.600 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:56:26.601 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:56:26.601 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:56:26.601 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:56:26.605 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:58:46.207 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 21:58:46.207 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 21:58:46.208 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 21:58:46.208 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 21:58:46.208 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 21:58:46.208 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 21:58:46.208 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:58:46.208 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:58:46.208 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 21:58:46.209 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 21:58:46.209 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 21:58:46.209 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 21:58:46.209 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 21:58:46.210 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 21:58:46.210 | INFO     | __main__:fetch_reporting_data:65 - Führe Reporting-Query für Monat 2025-10 aus.
2025-10-07 21:58:46.211 | INFO     | __main__:get_db_connection:41 - Öffne SQLite-DB: /home/stephan/projects/wegpiraten/data/Wegpiraten Datenbank.sqlite3
2025-10-07 21:58:46.212 | INFO     | __main__:fetch_reporting_data:68 - 53 relevante Datensätze für Zeiterfassungs-Sheets geladen.
2025-10-07 21:58:46.245 | INFO     | __main__:<module>:179 - Reporting-Sheet K23-13 (SiCo)_2025-10.xlsx erfolgreich erstellt.
2025-10-07 22:12:51.545 | DEBUG    | __main__:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 22:12:51.546 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 22:12:51.547 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 22:12:51.547 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 22:12:51.547 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 22:12:51.547 | DEBUG    | __main__:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 22:12:51.547 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:12:51.547 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:12:51.548 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:12:51.548 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 22:12:51.548 | DEBUG    | __main__:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 22:12:51.548 | DEBUG    | __main__:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 22:12:53.733 | INFO     | __main__:<module>:181 - Projektwurzel: /home/stephan/projects/wegpiraten
2025-10-07 22:13:42.099 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 22:13:42.099 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 22:13:42.109 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 22:13:42.110 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 22:13:42.110 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 22:13:42.110 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 22:13:42.110 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:13:42.110 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:13:42.110 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:13:42.111 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 22:13:42.111 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 22:13:42.111 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 22:13:46.679 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:13:46.689 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:13:58.350 | INFO     | __main__:load_client_data:89 - Führe Client-Query für Monat 2025-08 aus.
2025-10-07 22:13:58.361 | INFO     | __main__:load_client_data:92 - 58 Klientendatensätze geladen.
2025-10-07 22:13:58.370 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:13:58.370 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:13:58.371 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.371 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K23-13: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.371 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.371 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K23-16: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.371 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.371 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K23-33: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.372 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.372 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K23-47: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.372 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.372 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K23-52: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.372 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.372 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K23-53: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.373 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.373 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-12: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.373 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.373 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-14: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.373 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.373 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-15: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.373 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.374 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-20: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.374 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.374 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-21: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.374 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.374 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-23: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.374 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.375 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-25: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.375 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.375 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-27: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.375 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.375 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-28: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.375 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.376 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-3: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.376 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.376 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-32: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.376 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.376 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-37: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.376 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.377 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-4: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.377 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.377 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-42: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.377 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.377 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-43: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.377 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.377 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-45: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.378 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.378 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-46: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.378 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.378 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-50: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.378 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.378 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-51: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.379 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.379 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K24-57: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.379 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.379 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-10: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.379 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.379 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-11: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.380 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.380 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-17: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.380 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.380 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-18: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.380 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.380 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-19: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.381 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.381 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-22: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.381 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.381 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-24: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.381 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.381 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-26: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.381 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.382 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-30: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.382 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.382 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-31: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.382 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.382 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-34: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.382 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.382 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-35: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.383 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.383 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-36: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.383 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.383 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-38: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.383 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.383 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-39: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.384 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.384 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-40: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.384 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.384 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-41: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.384 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.384 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-44: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.384 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.385 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-48: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.385 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.385 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-49: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.385 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.385 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-5: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.385 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.385 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-54: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.386 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.386 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-55: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.386 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.386 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-56: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.386 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.386 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-58: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.387 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.387 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-6: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.387 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.387 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-60: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.387 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.387 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-61: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.387 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.388 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-62: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.388 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.388 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-63: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.388 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.388 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-8: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.388 | ERROR    | zeiterfassungen.modules.reporting_factory:create_reporting_sheet:95 - Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:13:58.388 | ERROR    | __main__:run:130 - Fehler beim Erstellen des Sheets für Client K25-9: Fehler beim Laden des Templates: [Errno 2] No such file or directory: 'templates/templates/zeiterfassungsboegen.xlsx'
2025-10-07 22:15:39.395 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 22:15:39.397 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 22:15:39.397 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 22:15:39.397 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 22:15:39.397 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 22:15:39.398 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 22:15:39.398 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:15:39.398 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:15:39.398 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:15:39.398 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 22:15:39.398 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 22:15:39.398 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 22:15:40.256 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:15:40.286 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:15:57.645 | INFO     | __main__:load_client_data:89 - Führe Client-Query für Monat 2025-08 aus.
2025-10-07 22:15:57.656 | INFO     | __main__:load_client_data:92 - 58 Klientendatensätze geladen.
2025-10-07 22:15:57.665 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:15:57.665 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:15:57.791 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (SiCo, Client-ID: K23-13) -> K23-13 (SiCo)_2025-08.xlsx
2025-10-07 22:15:57.877 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (AmEl, Client-ID: K23-16) -> K23-16 (AmEl)_2025-08.xlsx
2025-10-07 22:15:57.967 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (LuNi, Client-ID: K23-33) -> K23-33 (LuNi)_2025-08.xlsx
2025-10-07 22:15:58.054 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (AaSi, Client-ID: K23-47) -> K23-47 (AaSi)_2025-08.xlsx
2025-10-07 22:15:58.138 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (VaSt, Client-ID: K23-52) -> K23-52 (VaSt)_2025-08.xlsx
2025-10-07 22:15:58.235 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (MaSt, Client-ID: K23-53) -> K23-53 (MaSt)_2025-08.xlsx
2025-10-07 22:15:58.323 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (ErCi, Client-ID: K24-12) -> K24-12 (ErCi)_2025-08.xlsx
2025-10-07 22:15:58.415 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (EiDo, Client-ID: K24-14) -> K24-14 (EiDo)_2025-08.xlsx
2025-10-07 22:15:58.505 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LuDu, Client-ID: K24-15) -> K24-15 (LuDu)_2025-08.xlsx
2025-10-07 22:15:58.602 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (IlGo, Client-ID: K24-20) -> K24-20 (IlGo)_2025-08.xlsx
2025-10-07 22:15:58.694 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (SaHe, Client-ID: K24-21) -> K24-21 (SaHe)_2025-08.xlsx
2025-10-07 22:15:58.784 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (XiHu, Client-ID: K24-23) -> K24-23 (XiHu)_2025-08.xlsx
2025-10-07 22:15:58.873 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (SiKr, Client-ID: K24-25) -> K24-25 (SiKr)_2025-08.xlsx
2025-10-07 22:15:58.961 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (JaLe, Client-ID: K24-27) -> K24-27 (JaLe)_2025-08.xlsx
2025-10-07 22:15:59.060 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (JoLo, Client-ID: K24-28) -> K24-28 (JoLo)_2025-08.xlsx
2025-10-07 22:15:59.183 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (HeVo, Client-ID: K24-3) -> K24-3 (HeVo)_2025-08.xlsx
2025-10-07 22:15:59.279 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (HeMo, Client-ID: K24-32) -> K24-32 (HeMo)_2025-08.xlsx
2025-10-07 22:15:59.367 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (AlPi, Client-ID: K24-37) -> K24-37 (AlPi)_2025-08.xlsx
2025-10-07 22:15:59.458 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (DiAd, Client-ID: K24-4) -> K24-4 (DiAd)_2025-08.xlsx
2025-10-07 22:15:59.545 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (ZoRü, Client-ID: K24-42) -> K24-42 (ZoRü)_2025-08.xlsx
2025-10-07 22:15:59.635 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (MiRu, Client-ID: K24-43) -> K24-43 (MiRu)_2025-08.xlsx
2025-10-07 22:15:59.728 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (NaSa, Client-ID: K24-45) -> K24-45 (NaSa)_2025-08.xlsx
2025-10-07 22:15:59.818 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (BaSh, Client-ID: K24-46) -> K24-46 (BaSh)_2025-08.xlsx
2025-10-07 22:15:59.910 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (LiSt, Client-ID: K24-50) -> K24-50 (LiSt)_2025-08.xlsx
2025-10-07 22:16:00.004 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (MaSt2, Client-ID: K24-51) -> K24-51 (MaSt2)_2025-08.xlsx
2025-10-07 22:16:00.091 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (SaYa, Client-ID: K24-57) -> K24-57 (SaYa)_2025-08.xlsx
2025-10-07 22:16:00.180 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (SaCa, Client-ID: K25-10) -> K25-10 (SaCa)_2025-08.xlsx
2025-10-07 22:16:00.339 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (AnCa, Client-ID: K25-11) -> K25-11 (AnCa)_2025-08.xlsx
2025-10-07 22:16:00.473 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (EvEl, Client-ID: K25-17) -> K25-17 (EvEl)_2025-08.xlsx
2025-10-07 22:16:00.620 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (JoFe, Client-ID: K25-18) -> K25-18 (JoFe)_2025-08.xlsx
2025-10-07 22:16:00.718 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Johann (FaFl, Client-ID: K25-19) -> K25-19 (FaFl)_2025-08.xlsx
2025-10-07 22:16:00.812 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (TaHo, Client-ID: K25-22) -> K25-22 (TaHo)_2025-08.xlsx
2025-10-07 22:16:00.900 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (LuKr, Client-ID: K25-24) -> K25-24 (LuKr)_2025-08.xlsx
2025-10-07 22:16:00.986 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (EmKu, Client-ID: K25-26) -> K25-26 (EmKu)_2025-08.xlsx
2025-10-07 22:16:01.072 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (EnMi, Client-ID: K25-30) -> K25-30 (EnMi)_2025-08.xlsx
2025-10-07 22:16:01.160 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LiMo, Client-ID: K25-31) -> K25-31 (LiMo)_2025-08.xlsx
2025-10-07 22:16:01.247 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (ChOb, Client-ID: K25-34) -> K25-34 (ChOb)_2025-08.xlsx
2025-10-07 22:16:01.336 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (CePa, Client-ID: K25-35) -> K25-35 (CePa)_2025-08.xlsx
2025-10-07 22:16:01.425 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (LePe, Client-ID: K25-36) -> K25-36 (LePe)_2025-08.xlsx
2025-10-07 22:16:01.514 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LuPi, Client-ID: K25-38) -> K25-38 (LuPi)_2025-08.xlsx
2025-10-07 22:16:01.602 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (BaRi, Client-ID: K25-39) -> K25-39 (BaRi)_2025-08.xlsx
2025-10-07 22:16:01.698 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (NoRo, Client-ID: K25-40) -> K25-40 (NoRo)_2025-08.xlsx
2025-10-07 22:16:01.785 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (FaRo, Client-ID: K25-41) -> K25-41 (FaRo)_2025-08.xlsx
2025-10-07 22:16:01.872 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (AbSa, Client-ID: K25-44) -> K25-44 (AbSa)_2025-08.xlsx
2025-10-07 22:16:01.960 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Viktoria (ElSl, Client-ID: K25-48) -> K25-48 (ElSl)_2025-08.xlsx
2025-10-07 22:16:02.045 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Viktoria (JoSp, Client-ID: K25-49) -> K25-49 (JoSp)_2025-08.xlsx
2025-10-07 22:16:02.134 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (AnAk, Client-ID: K25-5) -> K25-5 (AnAk)_2025-08.xlsx
2025-10-07 22:16:02.219 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (NiWe, Client-ID: K25-54) -> K25-54 (NiWe)_2025-08.xlsx
2025-10-07 22:16:02.309 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (ArWi, Client-ID: K25-55) -> K25-55 (ArWi)_2025-08.xlsx
2025-10-07 22:16:02.403 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Lotti (NiWy, Client-ID: K25-56) -> K25-56 (NiWy)_2025-08.xlsx
2025-10-07 22:16:02.496 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (RaZi, Client-ID: K25-58) -> K25-58 (RaZi)_2025-08.xlsx
2025-10-07 22:16:02.589 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Barbara (AlAl, Client-ID: K25-6) -> K25-6 (AlAl)_2025-08.xlsx
2025-10-07 22:16:02.674 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für None (MaPe, Client-ID: K25-60) -> K25-60 (MaPe)_2025-08.xlsx
2025-10-07 22:16:02.764 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für None (JaSt, Client-ID: K25-61) -> K25-61 (JaSt)_2025-08.xlsx
2025-10-07 22:16:02.853 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für None (RaKl, Client-ID: K25-62) -> K25-62 (RaKl)_2025-08.xlsx
2025-10-07 22:16:02.937 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für None (JeFe, Client-ID: K25-63) -> K25-63 (JeFe)_2025-08.xlsx
2025-10-07 22:16:03.030 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (MaBl, Client-ID: K25-8) -> K25-8 (MaBl)_2025-08.xlsx
2025-10-07 22:16:03.114 | INFO     | __main__:run:125 - Erstelle AZ Erfassungsbogen für Mona (NoBu, Client-ID: K25-9) -> K25-9 (NoBu)_2025-08.xlsx
2025-10-07 22:19:36.916 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 22:19:36.917 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 22:19:36.918 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:19:36.919 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:19:36.920 | INFO     | zeiterfassungen.modules.reporting_processor:load_client_data:89 - Führe Client-Query für Monat 2025-10 aus.
2025-10-07 22:19:36.923 | INFO     | zeiterfassungen.modules.reporting_processor:load_client_data:92 - 53 Klientendatensätze geladen.
2025-10-07 22:19:36.927 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:19:36.927 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:19:36.974 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (SiCo, Client-ID: K23-13) -> K23-13 (SiCo)_2025-10.xlsx
2025-10-07 22:19:36.996 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (LuNi, Client-ID: K23-33) -> K23-33 (LuNi)_2025-10.xlsx
2025-10-07 22:19:37.020 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (AaSi, Client-ID: K23-47) -> K23-47 (AaSi)_2025-10.xlsx
2025-10-07 22:19:37.052 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (VaSt, Client-ID: K23-52) -> K23-52 (VaSt)_2025-10.xlsx
2025-10-07 22:19:37.078 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (MaSt, Client-ID: K23-53) -> K23-53 (MaSt)_2025-10.xlsx
2025-10-07 22:19:37.102 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (ErCi, Client-ID: K24-12) -> K24-12 (ErCi)_2025-10.xlsx
2025-10-07 22:19:37.126 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (EiDo, Client-ID: K24-14) -> K24-14 (EiDo)_2025-10.xlsx
2025-10-07 22:19:37.150 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LuDu, Client-ID: K24-15) -> K24-15 (LuDu)_2025-10.xlsx
2025-10-07 22:19:37.173 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (SaHe, Client-ID: K24-21) -> K24-21 (SaHe)_2025-10.xlsx
2025-10-07 22:19:37.199 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (XiHu, Client-ID: K24-23) -> K24-23 (XiHu)_2025-10.xlsx
2025-10-07 22:19:37.224 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (SiKr, Client-ID: K24-25) -> K24-25 (SiKr)_2025-10.xlsx
2025-10-07 22:19:37.249 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (JaLe, Client-ID: K24-27) -> K24-27 (JaLe)_2025-10.xlsx
2025-10-07 22:19:37.273 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (JoLo, Client-ID: K24-28) -> K24-28 (JoLo)_2025-10.xlsx
2025-10-07 22:19:37.304 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (HeVo, Client-ID: K24-3) -> K24-3 (HeVo)_2025-10.xlsx
2025-10-07 22:19:37.327 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (AlPi, Client-ID: K24-37) -> K24-37 (AlPi)_2025-10.xlsx
2025-10-07 22:19:37.352 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (ZoRü, Client-ID: K24-42) -> K24-42 (ZoRü)_2025-10.xlsx
2025-10-07 22:19:37.401 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (MiRu, Client-ID: K24-43) -> K24-43 (MiRu)_2025-10.xlsx
2025-10-07 22:19:37.425 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (NaSa, Client-ID: K24-45) -> K24-45 (NaSa)_2025-10.xlsx
2025-10-07 22:19:37.449 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (BaSh, Client-ID: K24-46) -> K24-46 (BaSh)_2025-10.xlsx
2025-10-07 22:19:37.472 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (LiSt, Client-ID: K24-50) -> K24-50 (LiSt)_2025-10.xlsx
2025-10-07 22:19:37.496 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (MaSt2, Client-ID: K24-51) -> K24-51 (MaSt2)_2025-10.xlsx
2025-10-07 22:19:37.519 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (SaCa, Client-ID: K25-10) -> K25-10 (SaCa)_2025-10.xlsx
2025-10-07 22:19:37.543 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (AnCa, Client-ID: K25-11) -> K25-11 (AnCa)_2025-10.xlsx
2025-10-07 22:19:37.566 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (EvEl, Client-ID: K25-17) -> K25-17 (EvEl)_2025-10.xlsx
2025-10-07 22:19:37.593 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (JoFe, Client-ID: K25-18) -> K25-18 (JoFe)_2025-10.xlsx
2025-10-07 22:19:37.619 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (FaFl, Client-ID: K25-19) -> K25-19 (FaFl)_2025-10.xlsx
2025-10-07 22:19:37.644 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (TaHo, Client-ID: K25-22) -> K25-22 (TaHo)_2025-10.xlsx
2025-10-07 22:19:37.669 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (LuKr, Client-ID: K25-24) -> K25-24 (LuKr)_2025-10.xlsx
2025-10-07 22:19:37.695 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (EmKu, Client-ID: K25-26) -> K25-26 (EmKu)_2025-10.xlsx
2025-10-07 22:19:37.719 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (EnMi, Client-ID: K25-30) -> K25-30 (EnMi)_2025-10.xlsx
2025-10-07 22:19:37.743 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LiMo, Client-ID: K25-31) -> K25-31 (LiMo)_2025-10.xlsx
2025-10-07 22:19:37.764 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (ChOb, Client-ID: K25-34) -> K25-34 (ChOb)_2025-10.xlsx
2025-10-07 22:19:37.787 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (CePa, Client-ID: K25-35) -> K25-35 (CePa)_2025-10.xlsx
2025-10-07 22:19:37.810 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (LePe, Client-ID: K25-36) -> K25-36 (LePe)_2025-10.xlsx
2025-10-07 22:19:37.834 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LuPi, Client-ID: K25-38) -> K25-38 (LuPi)_2025-10.xlsx
2025-10-07 22:19:37.859 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (BaRi, Client-ID: K25-39) -> K25-39 (BaRi)_2025-10.xlsx
2025-10-07 22:19:37.884 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (NoRo, Client-ID: K25-40) -> K25-40 (NoRo)_2025-10.xlsx
2025-10-07 22:19:37.904 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (FaRo, Client-ID: K25-41) -> K25-41 (FaRo)_2025-10.xlsx
2025-10-07 22:19:37.928 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (AbSa, Client-ID: K25-44) -> K25-44 (AbSa)_2025-10.xlsx
2025-10-07 22:19:37.953 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Viktoria (ElSl, Client-ID: K25-48) -> K25-48 (ElSl)_2025-10.xlsx
2025-10-07 22:19:37.979 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Viktoria (JoSp, Client-ID: K25-49) -> K25-49 (JoSp)_2025-10.xlsx
2025-10-07 22:19:38.006 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (AnAk, Client-ID: K25-5) -> K25-5 (AnAk)_2025-10.xlsx
2025-10-07 22:19:38.032 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (NiWe, Client-ID: K25-54) -> K25-54 (NiWe)_2025-10.xlsx
2025-10-07 22:19:38.055 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (ArWi, Client-ID: K25-55) -> K25-55 (ArWi)_2025-10.xlsx
2025-10-07 22:19:38.078 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (NiWy, Client-ID: K25-56) -> K25-56 (NiWy)_2025-10.xlsx
2025-10-07 22:19:38.102 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (RaZi, Client-ID: K25-58) -> K25-58 (RaZi)_2025-10.xlsx
2025-10-07 22:19:38.127 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (AlAl, Client-ID: K25-6) -> K25-6 (AlAl)_2025-10.xlsx
2025-10-07 22:19:38.149 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (MaPe, Client-ID: K25-60) -> K25-60 (MaPe)_2025-10.xlsx
2025-10-07 22:19:38.173 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (JaSt, Client-ID: K25-61) -> K25-61 (JaSt)_2025-10.xlsx
2025-10-07 22:19:38.195 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (RaKl, Client-ID: K25-62) -> K25-62 (RaKl)_2025-10.xlsx
2025-10-07 22:19:38.218 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (JeFe, Client-ID: K25-63) -> K25-63 (JeFe)_2025-10.xlsx
2025-10-07 22:19:38.243 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (MaBl, Client-ID: K25-8) -> K25-8 (MaBl)_2025-10.xlsx
2025-10-07 22:19:38.270 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (NoBu, Client-ID: K25-9) -> K25-9 (NoBu)_2025-10.xlsx
2025-10-07 22:20:35.115 | DEBUG    | shared_modules.config:__init__:51 - Lade Konfiguration von /home/stephan/projects/wegpiraten/.config/wegpiraten_config.yaml
2025-10-07 22:20:35.115 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'structure': {'prj_root': '/home/stephan/projects/wegpiraten', 'shared_data_path': '/mnt/c/Users/micro/OneDrive/Shared/Beatus/Wegpiraten Unterlagen', 'output_path': 'output', 'template_path': 'templates', 'tmp_path': '.tmp', 'log_path': '.logs', 'local_data_path': 'data', 'graphics': 'graphics'}
2025-10-07 22:20:35.115 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'database': {'sqlite_db_name': 'Wegpiraten Datenbank.sqlite3', 'db_name': 'Wegpiraten Datenbank.xlsx', 'db_encrypted': True}
2025-10-07 22:20:35.115 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'formatting': {'locale': 'de_CH', 'currency': 'CHF', 'currency_format': '#,##0.00 ¤', 'date_format': 'dd.MM.yyyy', 'numeric_format': '#,##0.00'}
2025-10-07 22:20:35.115 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'service_provider': {'name': 'Wegpiraten GmbH', 'street': 'Alpenstrasse 2', 'zip_code': '3800', 'city': 'Interlaken', 'phone': '+41 (0)76 790 67 56', 'email': 'info@wegpiraten.ch', 'website': 'www.wegpiraten.ch', 'uid': 'CHE-123.456.789 MWST', 'bank': 'Bank EKI Genossenschaft', 'iban': 'CH07 0839 3053 8385 3915 1'}
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:_parse_section:90 - Parsiere Abschnitt 'templates': {'invoice_template_name': 'rechnungsvorlage.docx', 'sheet_name': 'Pivot Rechnungsdaten', 'reporting_template': 'zeiterfassungsboegen.xlsx', 'client_sheet_name': 'MD_Klienten'}
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'employee': {'fields': [{'name': 'emp_id', 'type': 'str', 'primary_key': True, 'excel_column': 'PersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'fte', 'type': 'float', 'excel_column': 'FTE', 'format': '${numeric_format}'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'client': {'fields': [{'name': 'client_id', 'type': 'str', 'primary_key': True, 'excel_column': 'KlientNr'}, {'name': 'social_security_number', 'type': 'str', 'excel_column': 'SozVersNr'}, {'name': 'first_name', 'type': 'str', 'excel_column': 'Vorname'}, {'name': 'last_name', 'type': 'str', 'excel_column': 'Nachname'}, {'name': 'short_code', 'type': 'str', 'excel_column': 'Kürzel'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZdNr'}, {'name': 'service_requester_id', 'type': 'str', 'excel_column': 'LbNr'}, {'name': 'start_date', 'type': 'str', 'excel_column': 'Beginn', 'format': '${date_format}'}, {'name': 'end_date', 'type': 'str', 'excel_column': 'Ende', 'format': '${date_format}', 'optional': True}, {'name': 'employee_id', 'type': 'str', 'excel_column': 'MA_ID'}, {'name': 'allowed_hours_per_month', 'type': 'float', 'optional': True, 'excel_column': 'Stunden pro Monat', 'format': '${numeric_format}', 'sum': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'SPF / BBT'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'payer': {'fields': [{'name': 'payer_id', 'type': 'str', 'primary_key': True, 'excel_column': 'ZdNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'ZD_Name'}, {'name': 'name2', 'type': 'str', 'optional': True, 'excel_column': 'ZD_Name2'}, {'name': 'street', 'type': 'str', 'excel_column': 'ZD_Strasse'}, {'name': 'zip_code', 'type': 'str', 'excel_column': 'ZD_PLZ'}, {'name': 'city', 'type': 'str', 'excel_column': 'ZD_Ort'}, {'name': 'notes', 'type': 'str', 'excel_column': 'Kommentar', 'optional': True}]}
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'service_requester': {'fields': [{'name': 'service_requester_id', 'type': 'str', 'primary_key': True, 'excel_column': 'LBNr'}, {'name': 'name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}]}
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:_parse_entities:99 - Parsiere Entity-Modell 'invoice_data': {'fields': [{'name': 'invoice_number', 'type': 'str', 'primary_key': True, 'excel_column': 'Rechnungs-Nr'}, {'name': 'client_id', 'type': 'str', 'excel_column': 'Klient-Nr.'}, {'name': 'service_date', 'type': 'str', 'excel_column': 'Leistungsdatum', 'format': '${date_format}', 'is_position': True}, {'name': 'service_type', 'type': 'str', 'excel_column': 'Betreuungstyp'}, {'name': 'travel_time', 'type': 'float', 'excel_column': 'Fahrtzeit', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'direct_time', 'type': 'float', 'excel_column': 'Direkt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'indirect_time', 'type': 'float', 'excel_column': 'Indirekt', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'billable_hours', 'type': 'float', 'excel_column': 'Sollstunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'hourly_rate', 'type': 'currency', 'excel_column': 'Stundensatz', 'format': '${currency_format}', 'decimals': 2, 'is_position': False, 'sum': False}, {'name': 'total_hours', 'type': 'float', 'excel_column': 'Stunden', 'format': '${numeric_format}', 'decimals': 2, 'is_position': True, 'sum': True}, {'name': 'total_costs', 'type': 'currency', 'excel_column': 'Kosten', 'format': '${currency_format}', 'is_position': True, 'sum': True}, {'name': 'service_requester_name', 'type': 'str', 'excel_column': 'Leistungsbesteller'}, {'name': 'payer_id', 'type': 'str', 'excel_column': 'ZDNR'}]}
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:__init__:64 - Konfiguration erfolgreich geladen und validiert.
2025-10-07 22:20:35.116 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:20:35.118 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:20:35.118 | INFO     | zeiterfassungen.modules.reporting_processor:load_client_data:89 - Führe Client-Query für Monat 2025-10 aus.
2025-10-07 22:20:35.123 | INFO     | zeiterfassungen.modules.reporting_processor:load_client_data:92 - 53 Klientendatensätze geladen.
2025-10-07 22:20:35.125 | DEBUG    | shared_modules.config:get_decrypted_secret:163 - Versuche Secret 'SHEET_PASSWORD_ENC' mit Fernet-Key 'FERNET_KEY' zu entschlüsseln.
2025-10-07 22:20:35.126 | DEBUG    | shared_modules.config:get_decrypted_secret:170 - Secret erfolgreich entschlüsselt.
2025-10-07 22:20:35.179 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (SiCo, Client-ID: K23-13) -> K23-13 (SiCo)_2025-10.xlsx
2025-10-07 22:20:35.201 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (LuNi, Client-ID: K23-33) -> K23-33 (LuNi)_2025-10.xlsx
2025-10-07 22:20:35.225 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (AaSi, Client-ID: K23-47) -> K23-47 (AaSi)_2025-10.xlsx
2025-10-07 22:20:35.251 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (VaSt, Client-ID: K23-52) -> K23-52 (VaSt)_2025-10.xlsx
2025-10-07 22:20:35.272 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (MaSt, Client-ID: K23-53) -> K23-53 (MaSt)_2025-10.xlsx
2025-10-07 22:20:35.294 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (ErCi, Client-ID: K24-12) -> K24-12 (ErCi)_2025-10.xlsx
2025-10-07 22:20:35.318 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (EiDo, Client-ID: K24-14) -> K24-14 (EiDo)_2025-10.xlsx
2025-10-07 22:20:35.343 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LuDu, Client-ID: K24-15) -> K24-15 (LuDu)_2025-10.xlsx
2025-10-07 22:20:35.368 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (SaHe, Client-ID: K24-21) -> K24-21 (SaHe)_2025-10.xlsx
2025-10-07 22:20:35.394 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (XiHu, Client-ID: K24-23) -> K24-23 (XiHu)_2025-10.xlsx
2025-10-07 22:20:35.418 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (SiKr, Client-ID: K24-25) -> K24-25 (SiKr)_2025-10.xlsx
2025-10-07 22:20:35.441 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (JaLe, Client-ID: K24-27) -> K24-27 (JaLe)_2025-10.xlsx
2025-10-07 22:20:35.463 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (JoLo, Client-ID: K24-28) -> K24-28 (JoLo)_2025-10.xlsx
2025-10-07 22:20:35.486 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (HeVo, Client-ID: K24-3) -> K24-3 (HeVo)_2025-10.xlsx
2025-10-07 22:20:35.509 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (AlPi, Client-ID: K24-37) -> K24-37 (AlPi)_2025-10.xlsx
2025-10-07 22:20:35.533 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (ZoRü, Client-ID: K24-42) -> K24-42 (ZoRü)_2025-10.xlsx
2025-10-07 22:20:35.581 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (MiRu, Client-ID: K24-43) -> K24-43 (MiRu)_2025-10.xlsx
2025-10-07 22:20:35.604 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (NaSa, Client-ID: K24-45) -> K24-45 (NaSa)_2025-10.xlsx
2025-10-07 22:20:35.626 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (BaSh, Client-ID: K24-46) -> K24-46 (BaSh)_2025-10.xlsx
2025-10-07 22:20:35.649 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (LiSt, Client-ID: K24-50) -> K24-50 (LiSt)_2025-10.xlsx
2025-10-07 22:20:35.675 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (MaSt2, Client-ID: K24-51) -> K24-51 (MaSt2)_2025-10.xlsx
2025-10-07 22:20:35.700 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (SaCa, Client-ID: K25-10) -> K25-10 (SaCa)_2025-10.xlsx
2025-10-07 22:20:35.723 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (AnCa, Client-ID: K25-11) -> K25-11 (AnCa)_2025-10.xlsx
2025-10-07 22:20:35.747 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (EvEl, Client-ID: K25-17) -> K25-17 (EvEl)_2025-10.xlsx
2025-10-07 22:20:35.772 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (JoFe, Client-ID: K25-18) -> K25-18 (JoFe)_2025-10.xlsx
2025-10-07 22:20:35.796 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Johann (FaFl, Client-ID: K25-19) -> K25-19 (FaFl)_2025-10.xlsx
2025-10-07 22:20:35.818 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (TaHo, Client-ID: K25-22) -> K25-22 (TaHo)_2025-10.xlsx
2025-10-07 22:20:35.843 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (LuKr, Client-ID: K25-24) -> K25-24 (LuKr)_2025-10.xlsx
2025-10-07 22:20:35.869 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (EmKu, Client-ID: K25-26) -> K25-26 (EmKu)_2025-10.xlsx
2025-10-07 22:20:35.895 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (EnMi, Client-ID: K25-30) -> K25-30 (EnMi)_2025-10.xlsx
2025-10-07 22:20:35.918 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LiMo, Client-ID: K25-31) -> K25-31 (LiMo)_2025-10.xlsx
2025-10-07 22:20:35.941 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (ChOb, Client-ID: K25-34) -> K25-34 (ChOb)_2025-10.xlsx
2025-10-07 22:20:35.970 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (CePa, Client-ID: K25-35) -> K25-35 (CePa)_2025-10.xlsx
2025-10-07 22:20:35.993 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (LePe, Client-ID: K25-36) -> K25-36 (LePe)_2025-10.xlsx
2025-10-07 22:20:36.017 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (LuPi, Client-ID: K25-38) -> K25-38 (LuPi)_2025-10.xlsx
2025-10-07 22:20:36.042 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (BaRi, Client-ID: K25-39) -> K25-39 (BaRi)_2025-10.xlsx
2025-10-07 22:20:36.065 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (NoRo, Client-ID: K25-40) -> K25-40 (NoRo)_2025-10.xlsx
2025-10-07 22:20:36.090 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (FaRo, Client-ID: K25-41) -> K25-41 (FaRo)_2025-10.xlsx
2025-10-07 22:20:36.113 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (AbSa, Client-ID: K25-44) -> K25-44 (AbSa)_2025-10.xlsx
2025-10-07 22:20:36.136 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Viktoria (ElSl, Client-ID: K25-48) -> K25-48 (ElSl)_2025-10.xlsx
2025-10-07 22:20:36.163 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Viktoria (JoSp, Client-ID: K25-49) -> K25-49 (JoSp)_2025-10.xlsx
2025-10-07 22:20:36.186 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (AnAk, Client-ID: K25-5) -> K25-5 (AnAk)_2025-10.xlsx
2025-10-07 22:20:36.210 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (NiWe, Client-ID: K25-54) -> K25-54 (NiWe)_2025-10.xlsx
2025-10-07 22:20:36.235 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (ArWi, Client-ID: K25-55) -> K25-55 (ArWi)_2025-10.xlsx
2025-10-07 22:20:36.259 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Lotti (NiWy, Client-ID: K25-56) -> K25-56 (NiWy)_2025-10.xlsx
2025-10-07 22:20:36.280 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Isabelle (RaZi, Client-ID: K25-58) -> K25-58 (RaZi)_2025-10.xlsx
2025-10-07 22:20:36.303 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Barbara (AlAl, Client-ID: K25-6) -> K25-6 (AlAl)_2025-10.xlsx
2025-10-07 22:20:36.325 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (MaPe, Client-ID: K25-60) -> K25-60 (MaPe)_2025-10.xlsx
2025-10-07 22:20:36.347 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (JaSt, Client-ID: K25-61) -> K25-61 (JaSt)_2025-10.xlsx
2025-10-07 22:20:36.370 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (RaKl, Client-ID: K25-62) -> K25-62 (RaKl)_2025-10.xlsx
2025-10-07 22:20:36.393 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für None (JeFe, Client-ID: K25-63) -> K25-63 (JeFe)_2025-10.xlsx
2025-10-07 22:20:36.417 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (MaBl, Client-ID: K25-8) -> K25-8 (MaBl)_2025-10.xlsx
2025-10-07 22:20:36.441 | INFO     | zeiterfassungen.modules.reporting_processor:run:125 - Erstelle AZ Erfassungsbogen für Mona (NoBu, Client-ID: K25-9) -> K25-9 (NoBu)_2025-10.xlsx
